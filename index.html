<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ARTEMIS â€¢ MULTI-THREADED OS</title>
    <style>
        :root { --cyan: #00f2ff; --glass: rgba(0, 15, 25, 0.85); }
        body, html { margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:#000; font-family: monospace; }
        
        #bg-video { position: fixed; inset: 0; width: 100%; height: 100%; object-fit: cover; z-index: -1; filter: brightness(0.3); }

        /* Window Container */
        .holoframe {
            position: absolute; top: 5%; left: 5%; width: 90%; height: 80%;
            display: flex; flex-direction: column; border: 2px solid var(--cyan);
            border-radius: 12px; background: var(--glass); backdrop-filter: blur(15px);
            box-shadow: 0 0 30px rgba(0,242,255,0.2); z-index: 10;
        }
        .holoframe.hidden { display: none; }

        .holo-header {
            padding: 10px 20px; border-bottom: 1px solid var(--cyan);
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(0, 242, 255, 0.1); color: var(--cyan);
        }

        .iframe-wrapper { position: relative; flex: 1; background: #000; overflow: hidden; }
        iframe { width: 100%; height: 100%; border: none; }

        /* Portal Transition */
        .portal-overlay {
            position: absolute; inset: 0; z-index: 2000; background: #000;
            display: flex; justify-content: center; align-items: center;
        }
        .portal-video { width: 100%; height: 100%; object-fit: cover; }

        /* Tab / Thread Switcher */
        #thread-switcher {
            position: fixed; bottom: 85px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 10px; z-index: 2000;
        }
        .thread-pill {
            padding: 5px 15px; border: 1px solid var(--cyan); color: var(--cyan);
            background: rgba(0,0,0,0.7); cursor: pointer; font-size: 0.7rem;
        }
        .thread-pill.active { background: var(--cyan); color: #000; box-shadow: 0 0 10px var(--cyan); }

        /* Bottom Dock */
        .dock {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 20px; padding: 10px 30px;
            background: rgba(0,242,255,0.05); border: 1px solid var(--cyan);
            border-radius: 50px; backdrop-filter: blur(10px); z-index: 2000;
        }
        .dock-btn { cursor: pointer; color: var(--cyan); font-weight: bold; }
    </style>
</head>
<body>

<video id="bg-video" autoplay loop muted playsinline>
    <source src="https://raw.githubusercontent.com/highland88999-commits/artemis-hub/main/No_humans_pleas%20(1).mp4" type="video/mp4">
</video>

<div id="desktop"></div>

<div id="thread-switcher"></div>

<div class="dock">
    <div class="dock-btn" onclick="spawnFrame('https://artemis-hub.onrender.com', 'HUB')">NEW_THREAD +</div>
</div>

<script>
    let threads = [];
    let activeThreadId = null;

    function spawnFrame(url, name) {
        const id = 'thread-' + Date.now();
        const frameMarkup = `
            <div class="holoframe" id="${id}">
                <div class="holo-header">
                    <span>${name}</span>
                    <div onclick="terminateThread('${id}')" style="cursor:pointer; color:#ff3366;">[X]</div>
                </div>
                <div class="iframe-wrapper">
                    <div class="portal-overlay" id="portal-${id}">
                        <video class="portal-video" autoplay loop muted playsinline>
                            <source src="https://raw.githubusercontent.com/highland88999-commits/artemis-hub/main/VID_20260208225522.mp4" type="video/mp4">
                        </video>
                    </div>
                    <iframe id="iframe-${id}" src="${url}"></iframe>
                </div>
            </div>
        `;

        document.getElementById('desktop').insertAdjacentHTML('beforeend', frameMarkup);
        
        const iframe = document.getElementById(`iframe-${id}`);
        iframe.onload = () => {
            setTimeout(() => {
                document.getElementById(`portal-${id}`).style.display = 'none';
            }, 1500);
        };

        threads.push({ id, name });
        switchThread(id);
        updateSwitcher();
    }

    function switchThread(id) {
        threads.forEach(t => {
            document.getElementById(t.id).classList.toggle('hidden', t.id !== id);
        });
        activeThreadId = id;
        updateSwitcher();
    }

    function terminateThread(id) {
        document.getElementById(id).remove();
        threads = threads.filter(t => t.id !== id);
        if (threads.length > 0) switchThread(threads[threads.length - 1].id);
        else updateSwitcher();
    }

    function updateSwitcher() {
        const container = document.getElementById('thread-switcher');
        container.innerHTML = threads.map(t => `
            <div class="thread-pill ${t.id === activeThreadId ? 'active' : ''}" onclick="switchThread('${t.id}')">
                ${t.name}
            </div>
        `).join('');
    }

    // Listen for Hub Messages
    window.addEventListener('message', (event) => {
        if (event.data.type === 'load_site') {
            // Check if user wants a new tab or use existing
            if (event.data.newTab) {
                spawnFrame(event.data.url, event.data.name);
            } else {
                const currentIframe = document.getElementById(`iframe-${activeThreadId}`);
                const currentPortal = document.getElementById(`portal-${activeThreadId}`);
                currentPortal.style.display = 'flex';
                currentIframe.src = event.data.url;
                // Iframe.onload handles hiding portal
            }
        }
    });

    // Initial Spawn
    spawnFrame('https://artemis-hub.onrender.com', 'HUB');
</script>
</body>
</html>
